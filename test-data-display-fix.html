<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ•°æ®æ˜¾ç¤ºé€»è¾‘ä¿®å¤éªŒè¯</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 20px; 
            background: #f8fafc;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        .problem-found {
            background: #fef2f2;
            border: 1px solid #f87171;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        .fix-applied {
            background: #dcfce7;
            border: 1px solid #16a34a;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        .test-section {
            margin: 20px 0;
            padding: 20px;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
        }
        .log { 
            background: #f1f5f9; 
            padding: 10px; 
            margin: 10px 0; 
            border-radius: 4px; 
            font-family: monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
        }
        .success { color: #059669; }
        .info { color: #0284c7; }
        .warning { color: #d97706; }
        .error { color: #dc2626; }
        button { 
            padding: 8px 16px; 
            margin: 5px; 
            border: 1px solid #d1d5db;
            border-radius: 6px;
            background: white;
            cursor: pointer;
        }
        button:hover {
            background: #f9fafb;
        }
        .code-block {
            background: #1e293b;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 6px;
            font-family: monospace;
            font-size: 12px;
            margin: 10px 0;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ” æ•°æ®æ˜¾ç¤ºé€»è¾‘ä¿®å¤éªŒè¯</h1>
        
        <div class="problem-found">
            <h3>âŒ å‘ç°çš„é—®é¢˜</h3>
            <p><strong>é—®é¢˜1ï¼š</strong>ä»æˆªå›¾çœ‹åˆ°2025-12å’Œ2024-11éƒ½è¿”å›200çŠ¶æ€ï¼ˆæœ‰æ•°æ®ï¼‰ï¼Œä½†é¡µé¢è¿˜æ˜¯æ˜¾ç¤º"2025å¹´1æœˆè¿˜æœªé…ç½®è€ƒå‹¤ç¡®è®¤ä¿¡æ¯"</p>
            <p><strong>é—®é¢˜2ï¼š</strong>ç¼“å­˜æ•°æ®ä¸­éƒ¨é—¨å­—æ®µæ˜¾ç¤ºä¸ºç©ºï¼Œå­—æ®µæ˜ å°„ä¸æ­£ç¡®</p>
            
            <h4>ğŸ” æ ¹æœ¬åŸå› ï¼š</h4>
            <p><strong>çŠ¶æ€æ›´æ–°ä¸å®Œæ•´ï¼š</strong>æ•°æ®å¤„ç†é€»è¾‘æœ‰ç¼ºé™·</p>
            <ol>
                <li>APIè¿”å›æ•°æ®ï¼Œä½†å¤„ç†åtransformedSheetsä¸ºç©º</li>
                <li>åŸä»£ç åªåœ¨æœ‰æ•°æ®æ—¶æ‰è°ƒç”¨setSheets</li>
                <li>æ²¡æœ‰æ•°æ®æ—¶ä¸æ¸…é™¤ä¹‹å‰çš„sheetsErrorçŠ¶æ€</li>
                <li>å¯¼è‡´é¡µé¢æ˜¾ç¤ºæ—§çš„é”™è¯¯ä¿¡æ¯è€Œä¸æ˜¯æ•°æ®åˆ—è¡¨</li>
            </ol>
            
            <p><strong>éƒ¨é—¨å­—æ®µæ˜ å°„ä¸å®Œæ•´ï¼š</strong>APIè¿”å›çš„éƒ¨é—¨å­—æ®µåç§°ä¸æ˜ å°„é€»è¾‘ä¸åŒ¹é…</p>
            <ol>
                <li>APIå¯èƒ½è¿”å›ä¸åŒçš„éƒ¨é—¨å­—æ®µåç§°</li>
                <li>åŸæ˜ å°„é€»è¾‘è¦†ç›–çš„å­—æ®µåç§°ä¸å¤Ÿå…¨é¢</li>
                <li>éœ€è¦æ”¯æŒæ›´å¤šå¯èƒ½çš„å­—æ®µåç§°å˜ä½“</li>
            </ol>
        </div>
        
        <div class="fix-applied">
            <h3>âœ… ä¿®å¤æ–¹æ¡ˆ</h3>
            <p><strong>å®Œå–„çŠ¶æ€ç®¡ç†ï¼š</strong>ç¡®ä¿æ•°æ®å¤„ç†åæ­£ç¡®æ›´æ–°æ‰€æœ‰ç›¸å…³çŠ¶æ€</p>
            <p><strong>å¢å¼ºå­—æ®µæ˜ å°„ï¼š</strong>æ”¯æŒæ›´å¤šéƒ¨é—¨å­—æ®µåç§°å˜ä½“</p>
            
            <h4>ğŸ”§ ä¿®å¤å†…å®¹ï¼š</h4>
            <ol>
                <li><strong>æ— æ¡ä»¶æ›´æ–°sheetsï¼š</strong>æ— è®ºæ˜¯å¦æœ‰æ•°æ®éƒ½è°ƒç”¨setSheets</li>
                <li><strong>æ¸…é™¤é”™è¯¯çŠ¶æ€ï¼š</strong>æœ‰æ•°æ®æ—¶æ¸…é™¤sheetsError</li>
                <li><strong>è®¾ç½®å‹å¥½é”™è¯¯ï¼š</strong>æ— æ•°æ®æ—¶è®¾ç½®é€‚å½“çš„é”™è¯¯ä¿¡æ¯</li>
                <li><strong>çŠ¶æ€åŒæ­¥ï¼š</strong>ç¡®ä¿sheetså’ŒsheetsErrorçŠ¶æ€åŒæ­¥æ›´æ–°</li>
                <li><strong>æ‰©å±•éƒ¨é—¨å­—æ®µæ˜ å°„ï¼š</strong>æ”¯æŒdepartmentã€deptã€dept_nameã€department_nameã€deptNameã€departmentNameã€éƒ¨é—¨ç­‰å­—æ®µ</li>
                <li><strong>æ·»åŠ è°ƒè¯•æ—¥å¿—ï¼š</strong>è®°å½•å­—æ®µæ˜ å°„è¿‡ç¨‹ï¼Œä¾¿äºæ’æŸ¥é—®é¢˜</li>
            </ol>
        </div>
        
        <div class="test-section">
            <h3>ğŸ§ª ä¿®å¤é€»è¾‘éªŒè¯</h3>
            <button onclick="testDataDisplayLogic()">æµ‹è¯•æ•°æ®æ˜¾ç¤ºé€»è¾‘</button>
            <button onclick="testDepartmentFieldMapping()">æµ‹è¯•éƒ¨é—¨å­—æ®µæ˜ å°„</button>
            <button onclick="testEmployeeCrossReference()">æµ‹è¯•å‘˜å·¥æ•°æ®äº¤å‰å¼•ç”¨</button>
            <button onclick="simulateScenarios()">æ¨¡æ‹Ÿå„ç§åœºæ™¯</button>
            <button onclick="clearLogs()">æ¸…é™¤æ—¥å¿—</button>
        </div>
        
        <div class="test-section">
            <h3>ğŸ“‹ ä¿®å¤å‰åå¯¹æ¯”</h3>
            
            <h4>ä¿®å¤å‰çš„é—®é¢˜ä»£ç ï¼š</h4>
            <div class="code-block">
// âŒ é—®é¢˜ä»£ç ï¼šçŠ¶æ€æ›´æ–°ä¸å®Œæ•´
transformedSheets.sort((a, b) => b.month.localeCompare(a.month));
console.log('å¤„ç†å®Œæˆï¼Œè€ƒå‹¤å•æ•°é‡:', transformedSheets.length);

if (transformedSheets.length > 0) {
    setSheets(transformedSheets); // åªåœ¨æœ‰æ•°æ®æ—¶æ›´æ–°
}
// æ²¡æœ‰æ¸…é™¤sheetsErrorï¼Œå¯¼è‡´æ˜¾ç¤ºæ—§çš„é”™è¯¯ä¿¡æ¯
            </div>
            
            <h4>ä¿®å¤åçš„ä»£ç ï¼š</h4>
            <div class="code-block">
// âœ… ä¿®å¤ä»£ç ï¼šå®Œå–„çŠ¶æ€ç®¡ç†
transformedSheets.sort((a, b) => b.month.localeCompare(a.month));
console.log('å¤„ç†å®Œæˆï¼Œè€ƒå‹¤å•æ•°é‡:', transformedSheets.length);

// æ— è®ºæ˜¯å¦æœ‰æ•°æ®éƒ½è¦è®¾ç½®sheetsçŠ¶æ€ï¼Œæ¸…é™¤é”™è¯¯ä¿¡æ¯
setSheets(transformedSheets);
if (transformedSheets.length === 0) {
    // å¦‚æœå¤„ç†åæ²¡æœ‰æ•°æ®ï¼Œè®¾ç½®å‹å¥½çš„é”™è¯¯ä¿¡æ¯
    const monthText = globalMonth ? globalMonth.replace('-', 'å¹´') + 'æœˆ' : 'å½“å‰æœˆä»½';
    setSheetsError(`${monthText}è¿˜æœªé…ç½®è€ƒå‹¤ç¡®è®¤ä¿¡æ¯ï¼Œè¯·ç§»æ­¥è€ƒå‹¤ä»ªè¡¨ç›˜è®¾ç½®å¹¶ç¡®è®¤`);
} else {
    // æœ‰æ•°æ®æ—¶æ¸…é™¤é”™è¯¯ä¿¡æ¯
    setSheetsError(null);
}
            </div>
        </div>
        
        <div id="logs"></div>
    </div>

    <script>
        function log(message, type = 'info') {
            const logs = document.getElementById('logs');
            const div = document.createElement('div');
            div.className = `log ${type}`;
            div.innerHTML = `[${new Date().toLocaleTimeString()}] ${message}`;
            logs.appendChild(div);
            logs.scrollTop = logs.scrollHeight;
        }

        function clearLogs() {
            document.getElementById('logs').innerHTML = '';
        }

        function testEmployeeCrossReference() {
            log('ğŸ‘¥ å¼€å§‹æµ‹è¯•å‘˜å·¥æ•°æ®äº¤å‰å¼•ç”¨...', 'info');
            
            // æ¨¡æ‹Ÿå‘˜å·¥æ•°æ®
            const mockEmployees = [
                { userid: '001', name: 'å¼ ä¸‰', department: 'æŠ€æœ¯éƒ¨' },
                { userid: '002', name: 'æå››', department: 'äº§å“éƒ¨' },
                { userid: '003', name: 'ç‹äº”', department: 'è¿è¥éƒ¨' },
                { userid: '004', name: 'èµµå…­', department: 'å¸‚åœºéƒ¨' }
            ];
            
            // æ¨¡æ‹Ÿè€ƒå‹¤è®°å½•ï¼ˆæ²¡æœ‰éƒ¨é—¨ä¿¡æ¯ï¼‰
            const mockAttendanceRecords = [
                { userid: '001', username: 'å¼ ä¸‰' }, // æŒ‰useridåŒ¹é…
                { userid: '999', username: 'æå››' }, // useridä¸åŒ¹é…ï¼ŒæŒ‰å§“ååŒ¹é…
                { userid: '003', username: 'ç‹äº”', department: 'è´¢åŠ¡éƒ¨' }, // è€ƒå‹¤è®°å½•æœ‰éƒ¨é—¨ä¿¡æ¯ï¼Œåº”ä¼˜å…ˆä½¿ç”¨
                { userid: '005', username: 'é’±ä¸ƒ' }, // æ— æ³•åŒ¹é…
            ];
            
            mockAttendanceRecords.forEach((record, index) => {
                log(`<br>ğŸ“‹ æµ‹è¯•è®°å½• ${index + 1}: ${record.username}`, 'info');
                
                // æ¨¡æ‹Ÿéƒ¨é—¨å­—æ®µæ˜ å°„é€»è¾‘ï¼ˆåŒ…å«å‘˜å·¥æ•°æ®äº¤å‰å¼•ç”¨ï¼‰
                let departmentValue = record.department || '';
                
                if (!departmentValue && mockEmployees) {
                    const employeeId = record.userid || '';
                    const employeeName = record.username || '';
                    
                    // å…ˆæŒ‰useridåŒ¹é…
                    let matchedEmployee = mockEmployees.find(emp => emp.userid === employeeId);
                    
                    // å¦‚æœæŒ‰useridæ²¡æ‰¾åˆ°ï¼Œå°è¯•æŒ‰å§“ååŒ¹é…
                    if (!matchedEmployee && employeeName) {
                        matchedEmployee = mockEmployees.find(emp => emp.name === employeeName);
                    }
                    
                    if (matchedEmployee && matchedEmployee.department) {
                        departmentValue = matchedEmployee.department;
                    }
                }
                
                log(`   è¾“å…¥: userid=${record.userid}, username=${record.username}, department=${record.department || 'undefined'}`, 'info');
                log(`   åŒ¹é…ç»“æœ: ${departmentValue}`, departmentValue ? 'success' : 'error');
                log(`   åŒ¹é…æ–¹å¼: ${record.department ? 'è€ƒå‹¤è®°å½•ç›´æ¥åŒ…å«' : departmentValue ? 'å‘˜å·¥æ•°æ®äº¤å‰å¼•ç”¨' : 'æ— æ³•åŒ¹é…'}`, 'info');
            });
            
            log(`<br>ğŸ‰ å‘˜å·¥æ•°æ®äº¤å‰å¼•ç”¨æµ‹è¯•å®Œæˆ`, 'success');
            log('', 'info');
            log('ğŸ“ äº¤å‰å¼•ç”¨é€»è¾‘:', 'info');
            log('1. ä¼˜å…ˆä½¿ç”¨è€ƒå‹¤è®°å½•ä¸­çš„éƒ¨é—¨ä¿¡æ¯', 'info');
            log('2. å¦‚æœè€ƒå‹¤è®°å½•æ— éƒ¨é—¨ä¿¡æ¯ï¼ŒæŒ‰useridåŒ¹é…å‘˜å·¥æ•°æ®', 'info');
            log('3. å¦‚æœuseridåŒ¹é…å¤±è´¥ï¼ŒæŒ‰å§“ååŒ¹é…å‘˜å·¥æ•°æ®', 'info');
            log('4. å¦‚æœéƒ½åŒ¹é…å¤±è´¥ï¼Œéƒ¨é—¨å­—æ®µä¸ºç©º', 'info');
        }

        function testDepartmentFieldMapping() {
            log('ğŸ¢ å¼€å§‹æµ‹è¯•éƒ¨é—¨å­—æ®µæ˜ å°„...', 'info');
            
            // æ¨¡æ‹Ÿä¸åŒçš„APIæ•°æ®ç»“æ„
            const testRecords = [
                {
                    name: 'æ ‡å‡†departmentå­—æ®µ',
                    record: { userid: '001', username: 'å¼ ä¸‰', department: 'æŠ€æœ¯éƒ¨' },
                    expected: 'æŠ€æœ¯éƒ¨'
                },
                {
                    name: 'deptå­—æ®µ',
                    record: { userid: '002', username: 'æå››', dept: 'äº§å“éƒ¨' },
                    expected: 'äº§å“éƒ¨'
                },
                {
                    name: 'dept_nameå­—æ®µ',
                    record: { userid: '003', username: 'ç‹äº”', dept_name: 'è¿è¥éƒ¨' },
                    expected: 'è¿è¥éƒ¨'
                },
                {
                    name: 'department_nameå­—æ®µ',
                    record: { userid: '004', username: 'èµµå…­', department_name: 'å¸‚åœºéƒ¨' },
                    expected: 'å¸‚åœºéƒ¨'
                },
                {
                    name: 'deptNameå­—æ®µ',
                    record: { userid: '005', username: 'é’±ä¸ƒ', deptName: 'è´¢åŠ¡éƒ¨' },
                    expected: 'è´¢åŠ¡éƒ¨'
                },
                {
                    name: 'departmentNameå­—æ®µ',
                    record: { userid: '006', username: 'å­™å…«', departmentName: 'äººäº‹éƒ¨' },
                    expected: 'äººäº‹éƒ¨'
                },
                {
                    name: 'ä¸­æ–‡éƒ¨é—¨å­—æ®µ',
                    record: { userid: '007', username: 'å‘¨ä¹', éƒ¨é—¨: 'æ³•åŠ¡éƒ¨' },
                    expected: 'æ³•åŠ¡éƒ¨'
                },
                {
                    name: 'å¤šå­—æ®µä¼˜å…ˆçº§æµ‹è¯•',
                    record: { 
                        userid: '008', 
                        username: 'å´å',
                        department: 'æŠ€æœ¯éƒ¨',
                        dept: 'äº§å“éƒ¨',
                        dept_name: 'è¿è¥éƒ¨'
                    },
                    expected: 'æŠ€æœ¯éƒ¨' // departmentå­—æ®µä¼˜å…ˆçº§æœ€é«˜
                },
                {
                    name: 'æ— éƒ¨é—¨å­—æ®µ',
                    record: { userid: '009', username: 'éƒ‘åä¸€' },
                    expected: ''
                }
            ];
            
            testRecords.forEach(test => {
                log(`ğŸ“‹ æµ‹è¯•: ${test.name}`, 'info');
                
                // æ¨¡æ‹Ÿå­—æ®µæ˜ å°„é€»è¾‘
                const departmentValue = test.record.department || 
                                      test.record.dept || 
                                      test.record.dept_name || 
                                      test.record.department_name || 
                                      test.record.deptName || 
                                      test.record.departmentName || 
                                      test.record.éƒ¨é—¨ || '';
                
                log(`   è¾“å…¥å­—æ®µ: ${JSON.stringify(test.record)}`, 'info');
                log(`   æ˜ å°„ç»“æœ: "${departmentValue}"`, 'info');
                log(`   æœŸæœ›ç»“æœ: "${test.expected}"`, 'info');
                
                if (departmentValue === test.expected) {
                    log(`   âœ… æ˜ å°„æ­£ç¡®`, 'success');
                } else {
                    log(`   âŒ æ˜ å°„é”™è¯¯: æœŸæœ›"${test.expected}", å®é™…"${departmentValue}"`, 'error');
                }
                
                log('', 'info');
            });
            
            log('ğŸ‰ éƒ¨é—¨å­—æ®µæ˜ å°„æµ‹è¯•å®Œæˆ', 'success');
            log('', 'info');
            log('ğŸ“ å­—æ®µæ˜ å°„ä¼˜å…ˆçº§:', 'info');
            log('1. department (æ ‡å‡†å­—æ®µ)', 'info');
            log('2. dept (ç®€å†™)', 'info');
            log('3. dept_name (ä¸‹åˆ’çº¿å‘½å)', 'info');
            log('4. department_name (å®Œæ•´ä¸‹åˆ’çº¿å‘½å)', 'info');
            log('5. deptName (é©¼å³°å‘½å)', 'info');
            log('6. departmentName (å®Œæ•´é©¼å³°å‘½å)', 'info');
            log('7. éƒ¨é—¨ (ä¸­æ–‡å­—æ®µ)', 'info');
        }

        function testDataDisplayLogic() {
            log('ğŸ§ª å¼€å§‹æµ‹è¯•æ•°æ®æ˜¾ç¤ºé€»è¾‘...', 'info');
            
            // æ¨¡æ‹Ÿä¸åŒçš„æ•°æ®å¤„ç†åœºæ™¯
            const scenarios = [
                {
                    name: 'æœ‰æ•°æ®åœºæ™¯',
                    apiData: { '2025-12': [{ mainCompany: 'eyewind', records: {} }] },
                    expectedSheets: 1,
                    expectedError: null
                },
                {
                    name: 'æ— æ•°æ®åœºæ™¯',
                    apiData: {},
                    expectedSheets: 0,
                    expectedError: '2026å¹´1æœˆè¿˜æœªé…ç½®è€ƒå‹¤ç¡®è®¤ä¿¡æ¯'
                },
                {
                    name: 'æ•°æ®è¿‡æ»¤åä¸ºç©º',
                    apiData: { '2025-12': [{ mainCompany: 'other', records: {} }] },
                    expectedSheets: 0,
                    expectedError: '2026å¹´1æœˆè¿˜æœªé…ç½®è€ƒå‹¤ç¡®è®¤ä¿¡æ¯'
                }
            ];
            
            scenarios.forEach(scenario => {
                log(`ğŸ“‹ æµ‹è¯•åœºæ™¯: ${scenario.name}`, 'info');
                
                // æ¨¡æ‹Ÿæ•°æ®å¤„ç†é€»è¾‘
                const recordsByMonth = scenario.apiData;
                const transformedSheets = [];
                const currentCompany = 'eyewind';
                const globalMonth = '2026-01';
                
                for (const [month, dbRecords] of Object.entries(recordsByMonth)) {
                    if (!Array.isArray(dbRecords) || dbRecords.length === 0) continue;
                    
                    if (globalMonth && month !== globalMonth) {
                        log(`   è·³è¿‡æœˆä»½ ${month}ï¼Œå½“å‰å…¨å±€æœˆä»½: ${globalMonth}`, 'warning');
                        continue;
                    }
                    
                    const filteredRecords = dbRecords.filter(record => record.mainCompany === currentCompany);
                    if (filteredRecords.length === 0) {
                        log(`   æœˆä»½ ${month} æ²¡æœ‰åŒ¹é…çš„å…¬å¸æ•°æ®`, 'warning');
                        continue;
                    }
                    
                    transformedSheets.push({
                        id: `sheet_${month}`,
                        month: month,
                        employeeRecords: filteredRecords
                    });
                }
                
                // ä¿®å¤åçš„çŠ¶æ€æ›´æ–°é€»è¾‘
                let sheets = transformedSheets;
                let sheetsError = null;
                
                if (transformedSheets.length === 0) {
                    const monthText = globalMonth ? globalMonth.replace('-', 'å¹´') + 'æœˆ' : 'å½“å‰æœˆä»½';
                    sheetsError = `${monthText}è¿˜æœªé…ç½®è€ƒå‹¤ç¡®è®¤ä¿¡æ¯ï¼Œè¯·ç§»æ­¥è€ƒå‹¤ä»ªè¡¨ç›˜è®¾ç½®å¹¶ç¡®è®¤`;
                }
                
                // éªŒè¯ç»“æœ
                log(`   å¤„ç†ç»“æœ: sheetsæ•°é‡=${sheets.length}, error=${sheetsError ? 'æœ‰' : 'æ— '}`, 'info');
                
                if (sheets.length === scenario.expectedSheets) {
                    log(`   âœ… sheetsæ•°é‡æ­£ç¡®: ${sheets.length}`, 'success');
                } else {
                    log(`   âŒ sheetsæ•°é‡é”™è¯¯: æœŸæœ›${scenario.expectedSheets}, å®é™…${sheets.length}`, 'error');
                }
                
                if ((sheetsError === null) === (scenario.expectedError === null)) {
                    log(`   âœ… é”™è¯¯çŠ¶æ€æ­£ç¡®`, 'success');
                } else {
                    log(`   âŒ é”™è¯¯çŠ¶æ€é”™è¯¯`, 'error');
                }
                
                log('', 'info');
            });
            
            log('ğŸ‰ æ•°æ®æ˜¾ç¤ºé€»è¾‘æµ‹è¯•å®Œæˆ', 'success');
        }

        function simulateScenarios() {
            log('ğŸ”„ æ¨¡æ‹Ÿå®é™…ä½¿ç”¨åœºæ™¯...', 'info');
            
            log('åœºæ™¯1: APIè¿”å›æœ‰æ•ˆæ•°æ®', 'info');
            log('  â†’ APIå“åº”: 200 OK', 'success');
            log('  â†’ æ•°æ®å¤„ç†: ç”ŸæˆtransformedSheets', 'info');
            log('  â†’ çŠ¶æ€æ›´æ–°: setSheets(data), setSheetsError(null)', 'success');
            log('  â†’ é¡µé¢æ˜¾ç¤º: SheetListç»„ä»¶ï¼ˆè€ƒå‹¤å•åˆ—è¡¨ï¼‰', 'success');
            
            log('åœºæ™¯2: APIè¿”å›æ•°æ®ä½†è¿‡æ»¤åä¸ºç©º', 'info');
            log('  â†’ APIå“åº”: 200 OK', 'success');
            log('  â†’ æ•°æ®å¤„ç†: è¿‡æ»¤åtransformedSheetsä¸ºç©º', 'warning');
            log('  â†’ çŠ¶æ€æ›´æ–°: setSheets([]), setSheetsError(message)', 'info');
            log('  â†’ é¡µé¢æ˜¾ç¤º: é”™è¯¯é¡µé¢ + åˆ›å»ºæŒ‰é’®', 'info');
            
            log('åœºæ™¯3: APIè¿”å›404', 'info');
            log('  â†’ APIå“åº”: 404 Not Found', 'error');
            log('  â†’ ç›´æ¥å¤„ç†: setSheetsError(message), setSheets([])', 'info');
            log('  â†’ é¡µé¢æ˜¾ç¤º: é”™è¯¯é¡µé¢ + åˆ›å»ºæŒ‰é’®', 'info');
            
            log('âœ… ä¿®å¤åçš„é¢„æœŸæ•ˆæœ:', 'success');
            log('â€¢ æœ‰æ•°æ®æ—¶: ç›´æ¥æ˜¾ç¤ºè€ƒå‹¤ç¡®è®¤å•åˆ—è¡¨', 'success');
            log('â€¢ æ— æ•°æ®æ—¶: æ˜¾ç¤ºå‹å¥½é”™è¯¯ä¿¡æ¯å’Œåˆ›å»ºæŒ‰é’®', 'success');
            log('â€¢ çŠ¶æ€åŒæ­¥: sheetså’ŒsheetsErrorçŠ¶æ€å§‹ç»ˆä¿æŒä¸€è‡´', 'success');
        }

        // é¡µé¢åŠ è½½æ—¶çš„åˆå§‹åŒ–
        window.onload = function() {
            log('æ•°æ®æ˜¾ç¤ºé€»è¾‘ä¿®å¤éªŒè¯å·¥å…·åŠ è½½å®Œæˆ', 'success');
            log('', 'info');
            log('ğŸ¯ ä¿®å¤çš„æ ¸å¿ƒé—®é¢˜:', 'info');
            log('â€¢ APIè¿”å›æ•°æ®ä½†é¡µé¢æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯', 'warning');
            log('â€¢ çŠ¶æ€æ›´æ–°ä¸å®Œæ•´å¯¼è‡´çš„æ˜¾ç¤ºå¼‚å¸¸', 'warning');
            log('â€¢ sheetså’ŒsheetsErrorçŠ¶æ€ä¸åŒæ­¥', 'warning');
            log('â€¢ ç¼“å­˜æ•°æ®ä¸­éƒ¨é—¨å­—æ®µæ˜¾ç¤ºä¸ºç©º', 'warning');
            log('', 'info');
            log('âœ… ä¿®å¤æ–¹æ¡ˆ:', 'info');
            log('â€¢ æ— æ¡ä»¶æ›´æ–°sheetsçŠ¶æ€', 'success');
            log('â€¢ æœ‰æ•°æ®æ—¶æ¸…é™¤é”™è¯¯ä¿¡æ¯', 'success');
            log('â€¢ æ— æ•°æ®æ—¶è®¾ç½®å‹å¥½é”™è¯¯', 'success');
            log('â€¢ ç¡®ä¿çŠ¶æ€åŒæ­¥æ›´æ–°', 'success');
            log('â€¢ æ‰©å±•éƒ¨é—¨å­—æ®µæ˜ å°„è¦†ç›–èŒƒå›´', 'success');
            log('â€¢ æ·»åŠ å­—æ®µæ˜ å°„è°ƒè¯•æ—¥å¿—', 'success');
            log('', 'info');
            log('ğŸ” ä¿®å¤åçš„é¢„æœŸæ•ˆæœ:', 'info');
            log('â€¢ æœ‰æ•°æ®: æ˜¾ç¤ºè€ƒå‹¤ç¡®è®¤å•åˆ—è¡¨', 'success');
            log('â€¢ æ— æ•°æ®: æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯å’Œåˆ›å»ºæŒ‰é’®', 'success');
            log('â€¢ çŠ¶æ€ä¸€è‡´: ä¸å†å‡ºç°çŠ¶æ€ä¸åŒæ­¥é—®é¢˜', 'success');
            log('â€¢ éƒ¨é—¨æ˜¾ç¤º: æ­£ç¡®æ˜ å°„å’Œæ˜¾ç¤ºéƒ¨é—¨ä¿¡æ¯', 'success');
            log('', 'info');
            log('ç°åœ¨å¯ä»¥å¼€å§‹éªŒè¯ä¿®å¤æ•ˆæœ...', 'info');
        };
    </script>
</body>
</html>