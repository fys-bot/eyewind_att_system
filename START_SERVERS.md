# 服务器启动说明

## 启动顺序

### 1. 启动后端服务器 (端口 5000)

```bash
cd server
npm run dev
```

服务器将在 `http://localhost:5000` 启动，你会看到类似以下的输出：

```
╔════════════════════════════════════════════════════════════╗
║                                                            ║
║   🚀 考勤规则配置服务器已启动                                ║
║                                                            ║
║   端口: 5000                                               ║
║   环境: development                                        ║
║                                                            ║
║   考勤状态 API (新增):                                       ║
║   POST   /api/v1/attendance/status/upsert                 ║
║   GET    /api/v1/attendance/status/load/:pathSegment?     ║
║                                                            ║
╚════════════════════════════════════════════════════════════╝
```

### 2. 启动前端开发服务器 (端口 3000)

```bash
npm run dev
```

前端将在 `http://localhost:3000` 启动，并自动代理 `/api` 请求到后端的 5000 端口。

## 验证服务

### 后端健康检查
```bash
curl http://localhost:5000/health
```

### 前端访问
打开浏览器访问 `http://localhost:3000`

### API测试
可以使用 `test-attendance-api.html` 文件测试新的考勤状态接口。

## 端口配置总结

- **前端 (Vite)**: 3000 端口
- **后端 (Express)**: 5000 端口
- **API代理**: 前端的 `/api` 请求自动代理到后端 5000 端口
- **考勤数据库**: 81.70.91.77:5432

## 故障排除

1. **端口冲突**: 如果 5000 端口被占用，可以设置环境变量 `PORT=其他端口`
2. **数据库连接**: 确保能够访问 81.70.91.77:5432
3. **代理问题**: 检查 `vite.config.ts` 中的代理配置
4. **CORS问题**: 后端已配置 CORS，应该不会有跨域问题